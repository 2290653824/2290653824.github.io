(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{417:function(v,_,e){"use strict";e.r(_);var t=e(4),i=Object(t.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h3",{attrs:{id:"一-icp-index-condition-pushdown-索引下推"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#一-icp-index-condition-pushdown-索引下推"}},[v._v("#")]),v._v(" 一.ICP （index Condition Pushdown）索引下推")]),v._v(" "),_("p",[v._v("服务于"),_("strong",[v._v("联合索引")]),v._v("，mysql5.6之后的新特性")]),v._v(" "),_("p",[_("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20221227172820799.png",alt:"image-20221227172820799"}})]),v._v(" "),_("p",[v._v("如上图所示，建立联合索引（name，age）")]),v._v(" "),_("p",[v._v("之后我们使用查询语句"),_("code",[v._v("select * from tuser where name like '张%' and age =10")])]),v._v(" "),_("p",[v._v("在5.6之前")]),v._v(" "),_("ol",[_("li",[v._v("通过联合索引查询到张猛和张三的主键")]),v._v(" "),_("li",[v._v("拿着主键1,4进行回表两次从而查到完整的数据，并在完整的数据集中比对age是否等于10再进行过滤")])]),v._v(" "),_("p",[v._v("缺点：回表次数较多，从而增加了io次数")]),v._v(" "),_("p",[v._v("5.6之后，出现索引下推")]),v._v(" "),_("ol",[_("li",[v._v("根据联合索引最左匹配原则会拿到张猛和张三两条数据")]),v._v(" "),_("li",[v._v("索引下推：如果能在"),_("strong",[v._v("二级索引")]),v._v("中拿到age，直接进行过滤，最后满足条件的再进行回表")]),v._v(" "),_("li",[v._v("张猛和张三通过索引下推过滤掉张猛，最后张三通过1次回表获得完整数据")])]),v._v(" "),_("p",[v._v("优点：通过在二级索引树上搜索时提前过滤减少回表次数，从而减少io次数。")]),v._v(" "),_("h2",{attrs:{id:"二-使用条件"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#二-使用条件"}},[v._v("#")]),v._v(" 二.使用条件")]),v._v(" "),_("ul",[_("li",[v._v("建立了联合索引")]),v._v(" "),_("li",[v._v("需要过滤的索引也必须在联合索引中")])]),v._v(" "),_("p",[v._v("例如：")]),v._v(" "),_("p",[v._v("sql语句："),_("code",[v._v("select * from tuser where name like '张%' and address='成都'")])]),v._v(" "),_("p",[v._v("address是没有出现在联合索引中，就无法使用索引下推")]),v._v(" "),_("p",[v._v("对于innodb引擎中icp只用于辅助索引。如果引用了子查询、或者存储过程，索引下推就会失效。")]),v._v(" "),_("ul",[_("li",[v._v("如何知道是否使用了索引下推？")])]),v._v(" "),_("p",[v._v("使用explain语句，在extra中可以看到use index condition")])])}),[],!1,null,null,null);_.default=i.exports}}]);