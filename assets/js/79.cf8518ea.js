(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{403:function(s,a,t){"use strict";t.r(a);var n=t(4),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"jvm常见工具介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jvm常见工具介绍"}},[s._v("#")]),s._v(" JVM常见工具介绍")]),s._v(" "),a("h3",{attrs:{id:"jinfo-查看配置信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jinfo-查看配置信息"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#jinfo-%E6%9F%A5%E7%9C%8B%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("jinfo(查看配置信息)")]),s._v(" "),a("p",[s._v("查看"),a("code",[s._v("Java")]),s._v("应用程序配置参数或者"),a("code",[s._v("JVM")]),s._v("系统属性，相关命令详情我们可以使用"),a("code",[s._v("-help")]),s._v("或者"),a("code",[s._v("man")]),s._v("命令查看，如下所示:")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxxxxtmp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# jinfo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("help\nUsage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    jinfo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("pid"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("to connect to running process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    jinfo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("executable "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("core"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("to connect to a core file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    jinfo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("server_id@"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("remote server IP or hostname"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("to connect to remote debug server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nwhere "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" is one of"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("flag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("         to "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("print")]),s._v(" the value of the named VM flag\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("flag "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("    to enable or disable the named VM flag\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("flag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("value"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" to set the named VM flag to the given value\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("flags               to "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("print")]),s._v(" VM flags\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("sysprops            to "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("print")]),s._v(" Java system properties\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("no option"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("          to "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("print")]),s._v(" both of the above\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("h "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("help           to "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("print")]),s._v(" this help message\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("为了演示，笔者在服务器上开启了一个Java应用，我们可以使用"),a("code",[s._v("jps")]),s._v("命令查看其进程"),a("code",[s._v("id")]),s._v(",可以看到笔者服务器中有一个"),a("code",[s._v("pid")]),s._v("为"),a("code",[s._v("19946")]),s._v("的Java进程。")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@iZ8vb7bhe4b8nhhhpavhwpZ tmp]# jps\n20104 Jps\n19946 jar\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("查看当前应用所有的配置参数以及系统配置属性命令为"),a("code",[s._v("jinfo pid")]),s._v("如下所示:")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@xxxxx tmp]# jinfo 19946\nAttaching to process ID 19946, please wait...\nDebugger attached successfully.\nServer compiler detected.\nJVM version is 25.202-b08\nJava System Properties:\n\njava.runtime.name = Java(TM) SE Runtime Environment\njava.vm.version = 25.202-b08\nsun.boot.library.path = /root/jdk8/jre/lib/amd64\njava.protocol.handler.pkgs = org.springframework.boot.loader\njava.vendor.url = http://java.oracle.com/\njava.vm.vendor = Oracle Corporation\npath.separator = :\nfile.encoding.pkg = sun.io\njava.vm.name = Java HotSpot(TM) 64-Bit Server VM\nsun.os.patch.level = unknown\nsun.java.launcher = SUN_STANDARD\nuser.country = US\nuser.dir = /tmp\n\n\n......\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[s._v("如果我们希望查看当前Java应用是否有配置某些信息，可以使用命令"),a("code",[s._v("jinfo -flag 配置选项 pid")]),s._v("，例如我们想查看当前应用是否有开启"),a("code",[s._v("gc选项")]),s._v("，可以使用下面这段命令")]),s._v(" "),a("p",[s._v("可以看到输出结果为"),a("code",[s._v("-XX:-PrintGC")]),s._v("，因为"),a("code",[s._v("PrintGC")]),s._v("前面是减号，这说明该选项并没有开启。")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxx tmp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# jinfo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("flag PrintGC "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19946")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("XX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("PrintGC\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("如果我们希望将这个选项开启，我们只需在参数前面加个+号即可，例如我们希望开启"),a("code",[s._v("gc选项")]),s._v("，我们只需键入如下命令")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxxxxtmp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# jinfo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("flag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("PrintGC "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19946")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("再次查看可以发现，选项生效了")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxxx tmp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# jinfo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("flag PrintGC "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19946")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("XX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("PrintGC\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("有些参数是键值对的形式，例如我们想配置dump日志的路径，我们也可以使用jinfo进行配置，命令格式为"),a("code",[s._v("jinfo -flag 参数=值 Java进程id")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("jinfo -flag HeapDumpPath=/tmp/dump.log 19946\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("打印JVM选项信息")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("jinfo -flags 4854\nAttaching to process ID 4854, please wait...\nDebugger attached successfully.\nServer compiler detected.\nJVM version is 25.202-b08\nNon-default VM flags: -XX:CICompilerCount=2 -XX:HeapDumpPath=null -XX:InitialHeapSize=33554432 -XX:MaxHeapSize=511705088 -XX:MaxNewSize=170524672 -XX:MinHeapDeltaBytes=196608 -XX:NewSize=11141120 -XX:OldSize=22413312 -XX:+PrintGC -XX:+UseCompressedClassPointers -XX:+UseCompressedOops -XX:+UseFastUnorderedTimeStamps\nCommand line:\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("查看应用属性，命令格式"),a("code",[s._v("jinfo -sysprops Java进程id")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("jinfo -sysprops 2341\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"jmap-查看堆区信息、对象信息等"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jmap-查看堆区信息、对象信息等"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#jmap-%E6%9F%A5%E7%9C%8B%E5%A0%86%E5%8C%BA%E4%BF%A1%E6%81%AF%E3%80%81%E5%AF%B9%E8%B1%A1%E4%BF%A1%E6%81%AF%E7%AD%89",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("jmap(查看堆区信息、对象信息等)")]),s._v(" "),a("p",[a("code",[s._v("jmap")]),s._v("作用:")]),s._v(" "),a("ol",[a("li",[s._v("查看使用的GC算法，堆的配置信息以及各个内存区域的内存使用情况")]),s._v(" "),a("li",[s._v("显示堆对象的统计信息，包括每一个"),a("code",[s._v("Java")]),s._v("类、对象数量、内存大小、类名称等")]),s._v(" "),a("li",[s._v("打印等会回收的对象的信息")]),s._v(" "),a("li",[s._v("生成"),a("code",[s._v("dump")]),s._v("文件，配合"),a("code",[s._v("jhat")]),s._v("使用")])]),s._v(" "),a("p",[s._v("查看堆内存使用情况 "),a("code",[s._v("jmap -heap Java进程id")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@iZ8vb7bhe4b8nhhhpavhwpZ tmp]# jmap -heap 25534\nAttaching to process ID 25534, please wait...\nDebugger attached successfully.\nServer compiler detected.\nJVM version is 25.202-b08\n\nusing thread-local object allocation.\nMark Sweep Compact GC\n\nHeap Configuration:\n   MinHeapFreeRatio         = 40\n   MaxHeapFreeRatio         = 70\n   MaxHeapSize              = 511705088 (488.0MB)\n   NewSize                  = 11141120 (10.625MB)\n   MaxNewSize               = 170524672 (162.625MB)\n   OldSize                  = 22413312 (21.375MB)\n   NewRatio                 = 2\n   SurvivorRatio            = 8\n   MetaspaceSize            = 21807104 (20.796875MB)\n   CompressedClassSpaceSize = 1073741824 (1024.0MB)\n   MaxMetaspaceSize         = 17592186044415 MB\n   G1HeapRegionSize         = 0 (0.0MB)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("p",[s._v("查看存活的"),a("code",[s._v("Java")]),s._v("对象，命令格式: "),a("code",[s._v("jmap -histo:live Java进程id")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@xxxtmp]# jmap -histo:live 25534\n\n num     #instances         #bytes  class name\n----------------------------------------------\n   1:         48676        7974952  [C\n   2:          7762        1873312  [I\n   3:         47785        1146840  java.lang.String\n   4:         12737        1120856  java.lang.reflect.Method\n   5:          8773         968912  java.lang.Class\n   6:         25572         818304  java.util.concurrent.ConcurrentHashMap$Node\n   7:         14108         564320  java.util.LinkedHashMap$Entry\n   8:          2712         509536  [B\n   9:          9308         494936  [Ljava.lang.Object;\n  10:          6345         493128  [Ljava.util.HashMap$Node;\n  11:          7001         392056  java.util.LinkedHashMap\n  12:         11255         360160  java.util.HashMap$Node\n  13:         15946         354528  [Ljava.lang.Class;\n  14:         18176         290816  java.lang.Object\n  15:          3447         248184  java.lang.reflect.Field\n  16:           124         192320  [Ljava.util.concurrent.ConcurrentHashMap$Node;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("p",[s._v("打印正在被回收的类,命令格式:"),a("code",[s._v("jmap -finalizerinfo Java进程id")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@xxxtmp]# jmap -finalizerinfo 25534\nAttaching to process ID 25534, please wait...\nDebugger attached successfully.\nServer compiler detected.\nJVM version is 25.202-b08\nNumber of objects pending for finalization: 0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("将存活的对象的信息存到二进制文件中")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" jmap -dump:live,format=b,file=/tmp/heap.bin 25534\nDumping heap to /tmp/heap.bin ...\nHeap dump file created\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("此时就可以使用"),a("code",[s._v("jhat")]),s._v("打开该文件,如下所示"),a("code",[s._v("jhat 文件名")]),s._v(",这时候我们就可以通过"),a("code",[s._v("7000")]),s._v("端口查看详情了。")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@xxxtmp]# jhat heap.bin\nReading from heap.bin...\nDump file created Wed Nov 02 20:21:18 CST 2022\nSnapshot read, resolving...\nResolving 346825 objects...\nChasing references, expect 69 dots.....................................................................\nEliminating duplicate references.....................................................................\nSnapshot resolved.\nStarted HTTP server on port 7000\nServer is ready.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h3",{attrs:{id:"jstat-常用-监控运行时状态信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jstat-常用-监控运行时状态信息"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#jstat-%E5%B8%B8%E7%94%A8-%E7%9B%91%E6%8E%A7%E8%BF%90%E8%A1%8C%E6%97%B6%E7%8A%B6%E6%80%81%E4%BF%A1%E6%81%AF",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("jstat(常用，监控运行时状态信息)")]),s._v(" "),a("p",[s._v("jstat用于监控虚拟机各种运行状态信息，显示虚拟机进程中装在、内存、垃圾收集、JIT编译等运行数据。")]),s._v(" "),a("p",[s._v("查看类加载信息，命令格式"),a("code",[s._v("jstat -class Java进程id")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@iZ8vb7bhe4b8nhhhpavhwpZ tmp]# jstat -class 2341\nLoaded  Bytes  Unloaded  Bytes     Time\n  8221 14604.3        1     0.9      12.74\n[root@iZ8vb7bhe4b8nhhhpavhwpZ tmp]#\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("查看编译统计信息"),a("code",[s._v("jstat -compiler Java进程id")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@xxxtmp]# jstat -compiler 2341\nCompiled Failed Invalid   Time   FailedType FailedMethod\n    4177      0       0    17.68          0\n[root@iZ8vb7bhe4b8nhhhpavhwpZ tmp]#\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("查看"),a("code",[s._v("gc")]),s._v("统计信息")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@iZ8vb7bhe4b8nhhhpavhwpZ tmp]# jstat -gc 2341\n S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT     GCT\n1408.0 1408.0  0.0   1020.3 11840.0   7493.1   29268.0    22168.5   42840.0 40613.5 5760.0 5311.9     65    0.401   2      0.213    0.613\n[root@iZ8vb7bhe4b8nhhhpavhwpZ tmp]#\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("每个表头的含义如下")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("1. S0C :年轻代中第一个survivor（幸存区）的容量 (字节)\n2. S1C :年轻代中第二个survivor（幸存区）的容量 (字节)\n3. S0U:年轻代中第一个survivor（幸存区）目前已使用空间 (字节)\n4. S1U:年轻代中第二个survivor（幸存区）目前已使用空间 (字节)\n5. EC:年轻代中Eden（伊甸园）的容量 (字节)\n6. EU:年轻代中Eden（伊甸园）目前已使用空间 (字节)\n7. OC:Old代的容量 (字节)\n8. OU:Old代目前已使用空间 (字节)\n9. PC:Perm(持久代)的容量 (字节)\n10. PU:Perm(持久代)目前已使用空间 (字节)\n11. YGC:从应用程序启动到采样时年轻代中gc次数\n12. YGCT:从应用程序启动到采样时年轻代中gc所用时间(s)\n13. FGC:从应用程序启动到采样时old代(全gc)gc次数\n14. FGCT:从应用程序启动到采样时old代(全gc)gc所用时间(s)\n15. GCT:从应用程序启动到采样时gc用的总时间(s)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("查看gc内存容量和元空间容量")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@xxxtmp]# jstat -gccapacity 2341\n NGCMN    NGCMX     NGC     S0C   S1C       EC      OGCMN      OGCMX       OGC         OC       MCMN     MCMX      MC     CCSMN    CCSMX     CCSC    YGC    FGC\n 10880.0 166528.0  14656.0 1408.0 1408.0  11840.0    21888.0   333184.0    29268.0    29268.0      0.0 1087488.0  42840.0      0.0 1048576.0   5760.0     65     2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("查看年轻代统计信息")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@xxxxtmp]# jstat -gcnew 2341\n S0C    S1C    S0U    S1U   TT MTT  DSS      EC       EU     YGC     YGCT\n1408.0 1408.0    0.0 1020.3  2  15  704.0  11840.0   7652.5     65    0.401\n[root@iZ8vb7bhe4b8nhhhpavhwpZ tmp]#\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("参数详情")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("1. S0C:年轻代中第一个survivor（幸存区）的容量 (字节)\n2. S1C:年轻代中第二个survivor（幸存区）的容量 (字节)\n3. S0U:年轻代中第一个survivor（幸存区）目前已使用空间 (字节)\n4. S1U:年轻代中第二个survivor（幸存区）目前已使用空间 (字节)\n5. TT:持有次数限制\n6. MTT:最大持有次数限制\n7. EC:年轻代中Eden（伊甸园）的容量 (字节)\n8. EU:年轻代中Eden（伊甸园）目前已使用空间 (字节)\n9. YGC:从应用程序启动到采样时年轻代中gc次数\n10. YGCT:从应用程序启动到采样时年轻代中gc所用时间(s)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h2",{attrs:{id:"了解jvm-gc日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#了解jvm-gc日志"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E4%BA%86%E8%A7%A3jvm-gc%E6%97%A5%E5%BF%97",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("了解JVM GC日志")]),s._v(" "),a("h3",{attrs:{id:"获取日志的两种方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取日志的两种方式"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E8%8E%B7%E5%8F%96%E6%97%A5%E5%BF%97%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("获取日志的两种方式")]),s._v(" "),a("p",[s._v("获取GC日志方式大抵有以下两种:")]),s._v(" "),a("ol",[a("li",[s._v("设定JVM参数,具体的命令参数为:")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-XX:+PrintGCDetails # 打印GC日志\n-XX:+PrintGCTimeStamps # 打印每一次触发GC时发生的时间\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ol",[a("li",[s._v("在服务器上监控:使用"),a("code",[s._v("jstat")]),s._v("查看,如下所示，命令格式为"),a("code",[s._v("jstat -gc pid 输出间隔时长 输出次数")])])]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xxxxx tmp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# jstat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("gc "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21608")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT     GCT\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1088.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1088.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("666.5")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8832.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3102.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21888.0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11286.8")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32512.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30346.5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4352.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3842.7")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.161")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.035")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.195")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1088.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1088.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("666.5")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8832.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3102.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21888.0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11286.8")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32512.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30346.5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4352.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3842.7")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.161")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.035")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.195")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1088.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1088.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("666.5")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8832.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3102.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21888.0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11286.8")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32512.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30346.5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4352.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3842.7")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.161")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.035")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.195")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1088.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1088.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("666.5")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8832.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3102.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21888.0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11286.8")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32512.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30346.5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4352.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3842.7")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.161")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.035")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.195")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1088.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1088.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("666.5")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8832.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3102.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21888.0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11286.8")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32512.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30346.5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4352.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3842.7")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.161")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.035")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.195")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h3",{attrs:{id:"常见配置参数解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见配置参数解析"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E5%B8%B8%E8%A7%81%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("常见配置参数解析")]),s._v(" "),a("p",[s._v("对应的JVM参数和含义笔者都注释解释了，读者可自行阅读")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-XX:NewSize=5M # 年轻代空间大小\n-XX:MaxNewSize=5M # 年轻代最大空间大小\n-XX:InitialHeapSize=10M # 初始化堆空间大小\n-XX:MaxHeapSize=10M # 最大堆内存\n-XX:SurvivorRatio=8 # eden占比，例如这里设置为8，那么eden和S0、S1区总体比例为8:1:1\n-XX:PretenureSizeThreshold=10M # 大于这个值的参数直接在老年代分配。这样做的目的是避免在Eden区和两个Survivor区之间发生大量的内存复制\n-XX:+UseParNewGC # 年轻代使用的GC算法\n-XX:+UseConcMarkSweepGC # 并行并发CMS垃圾回收器\n-XX:+PrintGCDetails  # 打印GC日志详情\n-XX:+PrintGCTimeStamps # 打印每次触发GC的时间\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("由上面的命令我可以知道堆区初始化内存和最大内存为"),a("code",[s._v("10M")]),s._v("，所以我们堆区的总空间为"),a("code",[s._v("10M")]),s._v("。 而年轻代的内存为"),a("code",[s._v("5M")]),s._v("，年轻代包含"),a("code",[s._v("Eden区")]),s._v("和"),a("code",[s._v("Survivor区")]),s._v("，由参数"),a("code",[s._v("XX:SurvivorRatio")]),s._v("可知"),a("code",[s._v("Eden")]),s._v("区占"),a("code",[s._v("8/10")]),s._v("，所以"),a("code",[s._v("Eden")]),s._v("区为"),a("code",[s._v("4M")]),s._v("，"),a("code",[s._v("Survivor区")]),s._v("总大小为"),a("code",[s._v("1M")]),s._v("，由于"),a("code",[s._v("Survivor")]),s._v("有两个所以每个"),a("code",[s._v("Survivor区")]),s._v("为"),a("code",[s._v("0.5M")]),s._v("。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627171240319.png",alt:"image-20230627171240319"}})]),s._v(" "),a("h3",{attrs:{id:"实践-基于idea调试应用程序了解堆jvm日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实践-基于idea调试应用程序了解堆jvm日志"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E5%AE%9E%E8%B7%B5-%E5%9F%BA%E4%BA%8Eidea%E8%B0%83%E8%AF%95%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E4%BA%86%E8%A7%A3%E5%A0%86jvm%E6%97%A5%E5%BF%97",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("(实践)基于IDEA调试应用程序了解堆JVM日志")]),s._v(" "),a("p",[s._v("为了演示如何查看"),a("code",[s._v("GC")]),s._v("日志，我们不妨写下这样一段代码，我们在计划将JVM年轻代设置为5M，首先创建3M的垃圾，然后创建2M的对象，触发"),a("code",[s._v("minor GC")]),s._v("。")]),s._v(" "),a("p",[s._v("编码如下所示:")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("public class gcTest {\n    public static void main(String[] args) {\n        //制造3M的垃圾\n        byte[] bytes = new byte[1024 * 1024];\n        bytes = new byte[1024 * 1024];\n        bytes = new byte[1024 * 1024];\n\n        //创建2M的新对象触发GC\n        byte[] byte2 = new byte[2 * 1024 * 1024];\n    }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("然后我在"),a("code",[s._v("IDEA")]),s._v("中的"),a("code",[s._v("JVM option")]),s._v("配日志下面这条命令，每一个参数的命令上面都给出了，不记得的读者可以翻到上文中查阅。")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-XX:NewSize=5M -XX:MaxNewSize=5M -XX:InitialHeapSize=10M -XX:MaxHeapSize=10M -XX:SurvivorRatio=8 -XX:PretenureSizeThreshold=10M -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:+PrintGCDetails -XX:+PrintGCTimeStamps\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://qiniuyun.sharkchili.com/img202304071111331.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[s._v("完成后运行代码，可以在控制台输出下面这样一段内容，我们不妨逐行解释一下详情")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://qiniuyun.sharkchili.com/img202304071111185.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[s._v("首先是第一行，意为"),a("code",[s._v("0.059s")]),s._v("触发"),a("code",[s._v("年轻代gc")]),s._v("，年轻代使用空间从"),a("code",[s._v("3655K")]),s._v("变为"),a("code",[s._v("512K")]),s._v(",而年轻代的总空间为"),a("code",[s._v("4608K(eden+有对象的s区)")]),s._v("。")]),s._v(" "),a("p",[s._v("后面"),a("code",[s._v("3655K->1671K(9728K)")]),s._v("则是堆区总空间大小"),a("code",[s._v("9728K")]),s._v("，使用空间由"),a("code",[s._v("3655K")]),s._v("变为"),a("code",[s._v("1671K")]),s._v("。")]),s._v(" "),a("p",[s._v("后续"),a("code",[s._v("Times")]),s._v("按顺序即用户、系统、时机耗时时间。")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.059")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("GC "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Allocation Failure"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.059")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ParNew"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 3655K"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("512K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("4608K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0008750")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" 3655K"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("1671K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("9728K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0009085")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Times"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("real")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("接下来这段则是年轻代堆区信息使用情况，可以看到eden大小为4096K，使用了78%。from和to"),a("code",[s._v("(即s区)")]),s._v("同理。")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v("Heap\n par "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("new")]),s._v(" generation   total 4608K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" used 3746K "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ff600000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ffb00000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ffb00000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  eden space 4096K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("78")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" used "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ff600000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ff9289d0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ffa00000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  from space 512K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" used "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ffa80000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ffb00000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ffb00000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  to   space 512K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" used "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ffa00000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ffa00000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ffa80000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("这一段以为老年代使用情况")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v(" concurrent mark"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("sweep generation total 5120K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" used 1159K "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ffb00000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000100000000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000100000000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("最后两段为元数据和class空间使用情况，不常用到，就不多做解释了。")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v(" Metaspace       used 3159K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" capacity 4496K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" committed 4864K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" reserved 1056768K\n  class space    used 343K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" capacity 388K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" committed 512K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" reserved 1048576K\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"了解jvm几种gc的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#了解jvm几种gc的区别"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E4%BA%86%E8%A7%A3jvm%E5%87%A0%E7%A7%8Dgc%E7%9A%84%E5%8C%BA%E5%88%AB",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("了解JVM几种GC的区别")]),s._v(" "),a("ol",[a("li",[a("code",[s._v("Minor GC:")]),s._v("发生在年轻代的空间回收，包含"),a("code",[s._v("eden")]),s._v("和"),a("code",[s._v("survivor")]),s._v("，也叫做"),a("code",[s._v("Young GC")]),s._v("。")]),s._v(" "),a("li",[a("code",[s._v("Major GC:")]),s._v("在老年代堆区进行空间回收。")]),s._v(" "),a("li",[a("code",[s._v("Full GC:")]),s._v("清理所有堆区的内存空间的垃圾内存，包括年轻代和老年代。")])]),s._v(" "),a("h2",{attrs:{id:"实践-修复频繁的-minor-gc-和-major-gc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实践-修复频繁的-minor-gc-和-major-gc"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E5%AE%9E%E8%B7%B5-%E4%BF%AE%E5%A4%8D%E9%A2%91%E7%B9%81%E7%9A%84-minor-gc-%E5%92%8C-major-gc",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("(实践)修复频繁的 Minor GC 和 Major GC")]),s._v(" "),a("h3",{attrs:{id:"了解频繁minor-gc的危害和原因"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#了解频繁minor-gc的危害和原因"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E4%BA%86%E8%A7%A3%E9%A2%91%E7%B9%81minor-gc%E7%9A%84%E5%8D%B1%E5%AE%B3%E5%92%8C%E5%8E%9F%E5%9B%A0",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("了解频繁Minor GC的危害和原因")]),s._v(" "),a("p",[s._v("造成"),a("code",[s._v("Minor GC")]),s._v("的原因说白了就是年轻代空间太少，当我们的应用程序需要频繁的创建对象时，就会触发"),a("code",[s._v("Minor GC")]),s._v("。 频繁的"),a("code",[s._v("Minor GC")]),s._v("会导致服务响应时间变长，而原因也很好理解，由上的介绍我们知道频繁的"),a("code",[s._v("Minor GC")]),s._v("会导致大量的年轻代垃圾被回收，并且会将存活的对象拷贝的老年代，而拷贝这个行为是非常消耗系统性能的。")]),s._v(" "),a("h3",{attrs:{id:"复现问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#复现问题"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E5%A4%8D%E7%8E%B0%E9%97%AE%E9%A2%98",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("复现问题")]),s._v(" "),a("p",[s._v("我们的程序编写如下所示，在一个for循环里面，创建"),a("code",[s._v("3M")]),s._v("的垃圾后，再创建"),a("code",[s._v("2M")]),s._v("的数组触发"),a("code",[s._v("GC")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("public class gcTest {\n    public static void main(String[] args) throws Exception {\n        while (true) {\n            //制造3M的垃圾\n            byte[] bytes = new byte[1024 * 1024];\n            bytes = new byte[1024 * 1024];\n            bytes = new byte[1024 * 1024];\n\n            //创建2M的新对象触发GC\n            byte[] byte2 = new byte[2 * 1024 * 1024];\n\n            Thread.sleep(1000);\n        }\n\n\n    }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("为了演示年轻代的回收行为，我们需要在对这个应用程序的年轻代堆内存改为"),a("code",[s._v("5M")])]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-XX:NewSize=5M -XX:MaxNewSize=5M -XX:InitialHeapSize=10M -XX:MaxHeapSize=10M -XX:SurvivorRatio=8 -XX:PretenureSizeThreshold=10M -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:+PrintGCDetails -XX:+PrintGCTimeStamps\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("输出结果如下，可以看到在1s多就频繁的"),a("code",[s._v("Minor GC")]),s._v("。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://qiniuyun.sharkchili.com/img202304071111509.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("h3",{attrs:{id:"修复并解决问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修复并解决问题"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E4%BF%AE%E5%A4%8D%E5%B9%B6%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("修复并解决问题")]),s._v(" "),a("p",[s._v("我们不妨将年轻代和老年代、初始化堆区的空间都扩大，如下所示")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-XX:NewSize=10M -XX:MaxNewSize=10M -XX:InitialHeapSize=100M -XX:MaxHeapSize=100M -XX:SurvivorRatio=8 -XX:PretenureSizeThreshold=10M -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:+PrintGCDetails -XX:+PrintGCTimeStamps\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("输出结果，可以看到发生"),a("code",[s._v("GC")]),s._v("的时间间隔明显长了。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://qiniuyun.sharkchili.com/img202304071111220.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("h3",{attrs:{id:"将年轻代空间调大-是否会更加耗时"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#将年轻代空间调大-是否会更加耗时"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E5%B0%86%E5%B9%B4%E8%BD%BB%E4%BB%A3%E7%A9%BA%E9%97%B4%E8%B0%83%E5%A4%A7-%E6%98%AF%E5%90%A6%E4%BC%9A%E6%9B%B4%E5%8A%A0%E8%80%97%E6%97%B6",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("将年轻代空间调大，是否会更加耗时？")]),s._v(" "),a("p",[s._v("答案是不会的，我们将一次"),a("code",[s._v("GC")]),s._v("的时间拆分为"),a("code",[s._v("t1")]),s._v("和"),a("code",[s._v("t2")]),s._v("，"),a("code",[s._v("t1")]),s._v("是扫描年轻代空间是否有垃圾的时间，这个时间的几乎可以忽略不计。而t2则是将"),a("code",[s._v("eden")]),s._v("空间存活的对象复制到"),a("code",[s._v("survivor")]),s._v("区的时间，这个复制操作则是t1时间的10倍。 很明显的，JVM的性能瓶颈是t2"),a("code",[s._v("(拷贝存活对象到s区)")]),s._v("，所以增加年轻代空间避免没必要的拷贝是正确的做法。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://qiniuyun.sharkchili.com/img202304071111199.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("h2",{attrs:{id:"实践-频繁的full-gc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实践-频繁的full-gc"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E5%AE%9E%E8%B7%B5-%E9%A2%91%E7%B9%81%E7%9A%84full-gc",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("(实践)频繁的FULL GC")]),s._v(" "),a("h3",{attrs:{id:"简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E7%AE%80%E4%BB%8B",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("简介")]),s._v(" "),a("p",[a("code",[s._v("FULL GC")]),s._v("的原因即老年区空间满了，需要完完整整走一遍垃圾回收了。注意"),a("code",[s._v("FULL GC")]),s._v("可能会导致整个应用程序阻塞。")]),s._v(" "),a("h3",{attrs:{id:"重点-了解cms-gc日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重点-了解cms-gc日志"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E9%87%8D%E7%82%B9-%E4%BA%86%E8%A7%A3cms-gc%E6%97%A5%E5%BF%97",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("(重点)了解CMS GC日志")]),s._v(" "),a("p",[s._v("在进行FULL GC问题实践之前，我们必须了解一下CMS GC的七大阶段:")]),s._v(" "),a("ol",[a("li",[a("code",[s._v("Initial Mark")]),s._v(":首先是初始化标记阶段，这个阶段是STW"),a("code",[s._v("(stop the world即所有线程停止工作)")]),s._v("，它会标记出老年代中所有的"),a("code",[s._v("GC Roots")]),s._v("以及被年轻代中存活的对象引用的对象。")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://qiniuyun.sharkchili.com/img202304071111673.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[s._v("日志范例:")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://qiniuyun.sharkchili.com/img202304071111054.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("ol",[a("li",[a("code",[s._v("Concurrent Mark")]),s._v(":根据上一个阶段得到的"),a("code",[s._v("GC Roots")]),s._v("，遍历找出整个老年代中存活的对象，注意该阶段是和应用程序线程一起执行的。")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://qiniuyun.sharkchili.com/img202304071111192.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[s._v("日志范例:")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://qiniuyun.sharkchili.com/img202304071111115.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("ol",[a("li",[a("code",[s._v("Concurrent Mark")]),s._v(":这个阶段也是和应用程序线程并发工作的，它会将上一阶段运行期间引用关系发生变化的对象标记为"),a("code",[s._v("Dirty Card")]),s._v("。")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://qiniuyun.sharkchili.com/img202304071111707.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("ol",[a("li",[a("code",[s._v("Concurrent Abortable Preclean")]),s._v(":该阶段也是和应用程序线程并发执行的，它会尝试着去承担后续"),a("code",[s._v("STW")]),s._v("的"),a("code",[s._v("Final Remark")]),s._v("阶段的工作。")])]),s._v(" "),a("p",[s._v("日志范例：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://qiniuyun.sharkchili.com/img202304071111708.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("ol",[a("li",[a("code",[s._v("Final Remark")]),s._v(":这个阶段是"),a("code",[s._v("STW")]),s._v("的，会标记出老年代中所有存活的对象。")])]),s._v(" "),a("p",[s._v("日志范例")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://qiniuyun.sharkchili.com/img202304071111459.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("ol",[a("li",[s._v("Concurrent Sweep:和应用程序线程同时进行，移除那些不需要的对象，释放空间。")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://qiniuyun.sharkchili.com/img202304071111737.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[s._v("日志范例:")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://qiniuyun.sharkchili.com/img202304071111623.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("ol",[a("li",[a("code",[s._v("Concurrent Reset")]),s._v(":这个阶段并发执行，重新设置CMS算法内部的数据结构，准备下一个CMS生命周期的使用。")])]),s._v(" "),a("p",[s._v("日志范例:")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://qiniuyun.sharkchili.com/img202304071111820.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("h3",{attrs:{id:"问题复现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题复现"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E9%97%AE%E9%A2%98%E5%A4%8D%E7%8E%B0",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("问题复现")]),s._v(" "),a("p",[s._v("我们现在模拟一个场景，我们的web应用中有一个定时任务，这个定时任务每隔1s会想另一个定时任务线程池中提交100个任务。")]),s._v(" "),a("p",[s._v("注意spring boot应用要想开启定时任务必须添加"),a("code",[s._v("@EnableScheduling")]),s._v("注解。")]),s._v(" "),a("p",[s._v("代码如下所示:")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Component")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Task")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Logger")]),s._v(" logger "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LoggerFactory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getLogger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Task")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ScheduledThreadPoolExecutor")]),s._v(" executor "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ScheduledThreadPoolExecutor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ThreadPoolExecutor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DiscardOldestPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\t\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Obj")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" age "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" gender "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"man"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalDate")]),s._v(" birthday "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalDate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MAX")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//这个方法什么也不做")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//返回count个Obj对象")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Obj")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getObjList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Obj")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" objList "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                objList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Obj")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" objList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Scheduled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cron "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0/1 * *  * * ? "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//每1秒执行一次")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("execute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1s一次定时任务"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//向线程池提交100个任务")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Obj")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getObjList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" executor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("scheduleWithFixedDelay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n                i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TimeUnit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SECONDS")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br")])]),a("p",[s._v("完成后我们设置下面这段"),a("code",[s._v("JVM")]),s._v("参数后，将其启动")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xms20M")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xmx20M")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UseParNewGC")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UseConcMarkSweepGC")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintGCDetails")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintGCTimeStamps")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("不久后，控制台出现大量的"),a("code",[s._v("CMS GC")]),s._v("日志:")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.111")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GC")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Initial")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Mark")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("initial"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("mark"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("13695K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13696")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("19836K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19840")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0058731")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" real"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.01")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.117")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("mark"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.130")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("mark"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.013")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.013")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.05")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.02")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" real"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.01")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.130")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("preclean"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.133")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Full")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GC")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Allocation")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Failure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.133")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS1288")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("142")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("preclean"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.012")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.012")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.01")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" real"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.01")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("concurrent mode failure"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13695")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("13695K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13696")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0610050")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19839")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("19836K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19840")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Metaspace")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29026")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("29026K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1077248")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0610521")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.06")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" real"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.06")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.258")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Full")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GC")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Allocation")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Failure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.258")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13695")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("13695K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13696")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0612134")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19839")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("19836K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19840")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Metaspace")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29026")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("29026K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1077248")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0612676")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.06")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" real"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.06")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.320")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GC")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Initial")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Mark")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("initial"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("mark"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("13695K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13696")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("19836K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19840")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0041303")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.03")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" real"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.324")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("mark"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.339")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("mark"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.015")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.015")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.03")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" real"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.01")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.339")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("preclean"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.348")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("preclean"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.009")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.009")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" real"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.01")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.348")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("abortable"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("preclean"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.348")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("abortable"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("preclean"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" real"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.348")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GC")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Final")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Remark")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("YG")]),s._v(" occupancy"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6142")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("K")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6144")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.348")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Rescan")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parallel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0038030")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.352")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("weak refs processing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0000311")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.352")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" unloading"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0024908")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.355")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("scrub symbol table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0042932")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.359")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("scrub string table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0002748")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("remark"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("13695K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13696")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("19838K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19840")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0109811")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.02")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" real"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.01")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.360")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("sweep"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.364")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("sweep"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.005")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.005")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" real"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.364")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("reset"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.364")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("reset"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" real"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.384")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GC")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Allocation")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Failure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.384")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ParNew")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6143")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("6143K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6144")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0000365")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1288.384")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13695")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("13695K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13696")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0540105")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19839")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("19836K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19840")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Metaspace")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29026")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("29026K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1077248")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0541242")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.05")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" real"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.05")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h3",{attrs:{id:"排查思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#排查思路"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E6%8E%92%E6%9F%A5%E6%80%9D%E8%B7%AF",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("排查思路")]),s._v(" "),a("p",[s._v("随着时间的推移，我们发现控制台出现了大量FULL GC"),a("code",[s._v("(如果是生产环境，可能服务的响应速度会非常慢)")]),s._v("，所以我们首先需要定位这个进程的pid，首先在控制台输入"),a("code",[s._v("jps")]),s._v("找到进程，输出如下结果，可以看到这个"),a("code",[s._v("pid")]),s._v("为"),a("code",[s._v("7476")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10848")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KotlinCompileDaemon")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4832")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Jps")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7476")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JstackTestApplication")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8856")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RemoteMavenServer")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("然后我们使用"),a("code",[s._v("jstat")]),s._v("观察其"),a("code",[s._v("gc")]),s._v("情况,如下所示，可以看到每隔"),a("code",[s._v("10s")]),s._v("，就会增加大量的"),a("code",[s._v("FULL GC")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("C")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\\"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Users")]),s._v("\\xxx"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("jstat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("gc "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7476")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("S0C")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("S1C")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("S0U")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("S1U")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EC")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EU")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("OC")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("OU")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MC")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MU")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CCSC")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CCSU")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("YGC")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("YGCT")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FGC")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FGCT")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GCT")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5504.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("665.5")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13696.0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11176.2")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31488.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28992.6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4352.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3889.5")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.084")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.100")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.184")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5504.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1487.2")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13696.0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11176.2")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31488.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28992.6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4352.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3889.5")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.084")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.142")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.227")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5504.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1697.8")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13696.0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11176.2")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31488.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28992.6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4352.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3889.5")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.084")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.185")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.269")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5504.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2380.4")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13696.0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11176.2")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31488.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28992.6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4352.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3889.5")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.084")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("41")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.249")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.334")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5504.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3063.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13696.0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11176.2")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31488.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28992.6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4352.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3889.5")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.084")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("44")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.260")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.345")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5504.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3745.6")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13696.0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11176.2")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31488.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28992.6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4352.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3889.5")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.084")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("46")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.270")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.355")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5504.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4342.6")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13696.0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11176.2")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31488.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28992.6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4352.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3889.5")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.084")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.297")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.382")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("再查看"),a("code",[s._v("jmap")]),s._v("查看堆区使用情况")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v(" jmap "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("heap "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7476")]),s._v(" \nAttaching to process ID "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("26176")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" please wait"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\nDebugger attached successfully"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nServer compiler detected"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nJVM version is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25.212")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("b10\n\nusing parallel threads in the "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("new")]),s._v(" generation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nusing thread"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("local object allocation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nConcurrent Mark"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Sweep GC\n\nHeap Configuration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n   MinHeapFreeRatio         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v("\n   MaxHeapFreeRatio         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("70")]),s._v("\n   MaxHeapSize              "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20971520")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   NewSize                  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6946816")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("625MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   MaxNewSize               "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6946816")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("625MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   OldSize                  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14024704")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("375MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   NewRatio                 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n   SurvivorRatio            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\n   MetaspaceSize            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21807104")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("796875MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   CompressedClassSpaceSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1073741824")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   MaxMetaspaceSize         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17592186044415")]),s._v(" MB\n   G1HeapRegionSize         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nHeap Usage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\nNew Generation "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Eden "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" Survivor Space"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n   capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6291456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   used     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5088288")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("852569580078125MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   free     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1203168")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("147430419921875MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80.87615966796875")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" used\nEden Space"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n   capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5636096")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("375MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   used     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5088288")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("852569580078125MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   free     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("547808")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("522430419921875MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("90.28036428052326")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" used\nFrom Space"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n   capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("655360")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("625MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   used     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   free     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("655360")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("625MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" used\nTo Space"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n   capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("655360")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("625MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   used     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   free     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("655360")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("625MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" used\nconcurrent mark"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("sweep generation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n   capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14024704")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("375MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   used     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13819664")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("179458618164062MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   free     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("205040")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("1955413818359375MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("98.53800836010514")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" used\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12064")]),s._v(" interned Strings occupying "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1120288")]),s._v(" bytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br")])]),a("p",[s._v("在排除内存泄漏的问题后，我们通过"),a("code",[s._v("jstack")]),s._v("定位进程中导致是什么对象导致老年代堆区被大量占用，如下所示可以看到前20名中的对象都是和定时任务相关，有一个"),a("code",[s._v("Task$Obj")]),s._v("对象非常抢眼，很明显就是因为它的数量过多导致的，此时我们就可以通过定位代码确定如何解决，常见方案无非是: 优化代码、增加空间两种方式，一般来说我们都会采用代码优化的方式去解决。")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("$ jmap "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("histo "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7476")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" head "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\n\n num     #instances         #bytes  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" name\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50760")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3654720")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("ScheduledThreadPoolExecutor")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ScheduledFutureTask")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30799")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2901552")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("C")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("88986")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2847552")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("locks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("AbstractQueuedSynchronizer")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50700")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1622400")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("example"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jstackTest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Task")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Obj")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50760")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1218240")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Executors")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RunnableAdapter")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50700")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("811200")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("example"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jstackTest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Task")]),s._v("$$"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Lambda")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("587")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1605553313")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6391")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("707928")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Class")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29256")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("702144")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("String")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13577")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("434464")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("ConcurrentHashMap")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6363")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("341016")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ljava")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1722")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("312440")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("B")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3414")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("230424")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("I")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("210680")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ljava")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("concurrent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("RunnableScheduledFuture"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5223")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("208920")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("LinkedHashMap")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Entry")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2297")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("202136")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("reflect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Method")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2262")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("193760")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ljava")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("HashMap$"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5668")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("181376")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("HashMap")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Node")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[s._v("而本次问题也很明显，任务是一个个提交到定时任务线程池中，是由于定时任务队列"),a("code",[s._v("DelayedWorkQueue")]),s._v("不断堆积任务导致内存被打满。所以最终改成将一个批操作一次性提交到定时任务中得以解决")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v(" @"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Scheduled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cron "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0/1 * *  * * ? "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//每1秒执行一次")]),s._v("\n    public void "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("execute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1s一次定时任务"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//向线程池提交100个任务")]),s._v("\n\n\n        executor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("scheduleWithFixedDelay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    Obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getObjList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" TimeUnit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SECONDS\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h3",{attrs:{id:"补充-导致频繁full-gc三大原因"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#补充-导致频繁full-gc三大原因"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E8%A1%A5%E5%85%85-%E5%AF%BC%E8%87%B4%E9%A2%91%E7%B9%81full-gc%E4%B8%89%E5%A4%A7%E5%8E%9F%E5%9B%A0",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("补充:导致频繁FULL GC三大原因")]),s._v(" "),a("p",[s._v("我们需要需要具体分析才能得出解决方案，总的来说原因可以分为3个:")]),s._v(" "),a("ol",[a("li",[s._v("用户频繁调用"),a("code",[s._v("System.gc()")]),s._v(":这种情况需要修改代码即可，我们不该频繁调用这个方法的。")]),s._v(" "),a("li",[s._v("老年区空间过小:视情况适当扩大空间。")]),s._v(" "),a("li",[s._v("大对象过多:这种情况视情况决定是扩大老年代空间或者将大对象拆分。")])]),s._v(" "),a("h2",{attrs:{id:"更多jvm调优"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更多jvm调优"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E6%9B%B4%E5%A4%9Ajvm%E8%B0%83%E4%BC%98",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("更多JVM调优")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://tech.meituan.com/2017/12/29/jvm-optimize.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("从实际案例聊聊Java应用的GC优化(opens new window)"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://tech.meituan.com/2020/11/12/java-9-cms-gc.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Java中9种常见的CMS GC问题分析与解决(opens new window)"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://shuyi.tech/archives/have-a-try-in-jvm-combat",target:"_blank",rel:"noopener noreferrer"}},[s._v("听说 JVM 性能优化很难？今天我小试了一把！(opens new window)"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://heapdump.cn/article/1859160",target:"_blank",rel:"noopener noreferrer"}},[s._v("一次线上JVM调优实践，FullGC40次/天到10天一次的优化过程(opens new window)"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://blog.51cto.com/u_15281317/3008860",target:"_blank",rel:"noopener noreferrer"}},[s._v("线上频繁发生Full GC 如何调优？如何快速定位OOM、cpu飙升、线程死锁等问题(opens new window)"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"参考文献"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文献"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.sharkchili.com/pages/3361b8/#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE",target:"_blank",rel:"noopener noreferrer"}},[s._v("#"),a("OutboundLink")],1),s._v("参考文献")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.jianshu.com/p/d686e108d15f",target:"_blank",rel:"noopener noreferrer"}},[s._v("JVM学习（7）Stop-The-World(opens new window)"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/onmyway20xx/p/6590603.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("JVM调优——之CMS GC日志分析 (opens new window)"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("[从实际案例聊聊Java应用的GC优化(opens new window)](https://tech.meituan.com/2017/12/29/jvm-optimize.html#:~:text= 通常情况下，由于新生代空间较小，Eden区很快被填满，就会导致频繁Minor GC，因此可以通过增大新生代空间来降低Minor,GC的频率。 例如在相同的内存分配率的前提下，新生代中的Eden区增加一倍，Minor GC的次数就会减少一半。)")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/Alian_1223/article/details/120455623",target:"_blank",rel:"noopener noreferrer"}},[s._v("Spring Boot定时任务详解（线程池方式）(opens new window)"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/pan_junbiao/article/details/109399280",target:"_blank",rel:"noopener noreferrer"}},[s._v("SpringBoot使用@Scheduled注解实现定时任务(opens new window)"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://tobebetterjavaer.com/sidebar/sanfene/jvm.html#_39-%E9%A2%91%E7%B9%81-full-gc-%E6%80%8E%E4%B9%88%E5%8A%9E",target:"_blank",rel:"noopener noreferrer"}},[s._v("面渣逆袭（Java 虚拟机-JVM面试题八股文）必看👍"),a("OutboundLink")],1)]),s._v(" "),a("h1",{attrs:{id:"图灵"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#图灵"}},[s._v("#")]),s._v(" 图灵")]),s._v(" "),a("p",[a("strong",[s._v("前置启动程序")])]),s._v(" "),a("p",[s._v("事先启动一个web应用程序，用"),a("code",[s._v("jps")]),s._v("查看其进程id，接着用各种jdk自带命令优化应用")]),s._v(" "),a("h2",{attrs:{id:"_1-jmap"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-jmap"}},[s._v("#")]),s._v(" 1. Jmap")]),s._v(" "),a("p",[s._v("此命令可以用来查看内存信息，实例个数以及占用内存大小")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627144556221.png",alt:"image-20230627144556221"}})]),s._v(" "),a("h3",{attrs:{id:"jmap-histo-14660"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jmap-histo-14660"}},[s._v("#")]),s._v(" "),a("code",[s._v("jmap -histo 14660")])]),s._v(" "),a("p",[s._v("查看历史生成的实例")]),s._v(" "),a("h3",{attrs:{id:"jmap-histo-live-14660"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jmap-histo-live-14660"}},[s._v("#")]),s._v(" "),a("code",[s._v("jmap -histo:live 14660")])]),s._v(" "),a("p",[s._v("查看当前存活的实例，执行过程中可能会触发一次full gc")]),s._v(" "),a("p",[s._v("打开log.txt，文件内容如下：")]),s._v(" "),a("p",[s._v("​    "),a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627145012419.png",alt:"image-20230627145012419"}})]),s._v(" "),a("ul",[a("li",[s._v("num：序号")]),s._v(" "),a("li",[s._v("instances：实例数量")]),s._v(" "),a("li",[s._v("bytes：占用空间大小")]),s._v(" "),a("li",[s._v("class name：类名称，[C is a char[]，[S is a short[]，[I is a int[]，[B is a byte[]，[[I is a int[][]")])]),s._v(" "),a("h3",{attrs:{id:"jmap-heap-15660"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jmap-heap-15660"}},[s._v("#")]),s._v(" "),a("code",[s._v("jmap -heap 15660")])]),s._v(" "),a("p",[s._v("堆信息")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627145052974.png",alt:"image-20230627145052974"}})]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v(" ### `jmap -dump:format=b,file=eureka.hprof 14660 `\n")])])]),a("p",[s._v("堆内存dump")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627145100481.png",alt:"image-20230627145100481"}})]),s._v(" "),a("p",[s._v("其他生成堆内存信息的指令：")]),s._v(" "),a("p",[s._v("也可以设置内存溢出自动导出dump文件(内存很大的时候，可能会导不出来)")]),s._v(" "),a("ol",[a("li",[s._v("-XX:+HeapDumpOnOutOfMemoryError")]),s._v(" "),a("li",[s._v("-XX:HeapDumpPath=./  （路径）")])]),s._v(" "),a("p",[s._v("示例代码：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OOMTest")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" list "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// JVM设置     // -Xms10M -Xmx10M -XX:+PrintGCDetails -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=D:\\jvm.dump")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" list "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" j "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UUID")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("randomUUID")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("j"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UUID")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("randomUUID")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h3",{attrs:{id:"dump文件有什么用处"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dump文件有什么用处"}},[s._v("#")]),s._v(" dump文件有什么用处")]),s._v(" "),a("p",[s._v("①"),a("strong",[s._v("可以用jvisualvm命令工具导入该dump文件分析")])]),s._v(" "),a("p",[s._v("jvisualvm 可视化的展示，其实底层也是调用了jmap等相关的java工具命令")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627150029282.png",alt:"image-20230627150029282"}})]),s._v(" "),a("h2",{attrs:{id:"_2-jstack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-jstack"}},[s._v("#")]),s._v(" 2."),a("strong",[s._v("Jstack")])]),s._v(" "),a("p",[s._v("用jstack加进程id查找死锁，见如下示例")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DeadLockTest")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" lock1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" lock2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lock1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"thread1 begin"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lock2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"thread1 end"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lock2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"thread2 begin"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lock1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"thread2 end"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"main thread end"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br")])]),a("h3",{attrs:{id:"_1-jstack-进程号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-jstack-进程号"}},[s._v("#")]),s._v(" ① "),a("code",[s._v("jstack 进程号")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627150037144.png",alt:"image-20230627150037144"}})]),s._v(" "),a("p",[s._v('"Thread-1" 线程名')]),s._v(" "),a("p",[s._v("prio=5 优先级=5")]),s._v(" "),a("p",[s._v("tid=0x000000001fa9e000 线程id")]),s._v(" "),a("p",[s._v("nid=0x2d64 线程对应的本地线程标识nid")]),s._v(" "),a("p",[s._v("java.lang.Thread.State: BLOCKED 线程状态")]),s._v(" "),a("p",[s._v("​    "),a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627150049276.png",alt:"image-20230627150049276"}})]),s._v(" "),a("p",[s._v("还可以用jvisualvm自动检测死锁")]),s._v(" "),a("p",[s._v("​    "),a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627150101411.png",alt:"image-20230627150101411"}})]),s._v(" "),a("h3",{attrs:{id:"_2远程连接jvisualvm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2远程连接jvisualvm"}},[s._v("#")]),s._v(" ②"),a("strong",[s._v("远程连接jvisualvm")])]),s._v(" "),a("p",[a("strong",[s._v("启动普通的jar程序JMX端口配置：")])]),s._v(" "),a("p",[s._v("​                java -Dcom.sun.management.jmxremote.port=8888 -Djava.rmi.server.hostname=192.168.65.60 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false -jar microservice-eureka-server.jar")]),s._v(" "),a("p",[s._v("PS：")]),s._v(" "),a("p",[s._v("-Dcom.sun.management.jmxremote.port 为远程机器的JMX端口")]),s._v(" "),a("p",[s._v("-Djava.rmi.server.hostname 为远程机器IP")]),s._v(" "),a("p",[a("strong",[s._v("tomcat的JMX配置：在catalina.sh文件里的最后一个JAVA_OPTS的赋值语句下一行增加如下配置行")])]),s._v(" "),a("p",[s._v('​                JAVA_OPTS="$JAVA_OPTS -Dcom.sun.management.jmxremote.port=8888 -Djava.rmi.server.hostname=192.168.50.60 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false"')]),s._v(" "),a("p",[s._v("连接时确认下端口是否通畅，可以临时关闭下防火墙")]),s._v(" "),a("p",[s._v("​                systemctl stop firewalld   #临时关闭防火墙")]),s._v(" "),a("h3",{attrs:{id:"_3jstack找出占用cpu最高的线程堆栈信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3jstack找出占用cpu最高的线程堆栈信息"}},[s._v("#")]),s._v(" ③"),a("strong",[s._v("jstack找出占用cpu最高的线程堆栈信息")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Math")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" initData "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("666")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("compute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//一个方法对应一块栈帧内存区域")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" b "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" c "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("a "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Math")]),s._v(" math "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Math")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("compute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("p",[s._v("1，使用命令top -p  ，显示你的java进程的内存情况，pid是你的java进程号，比如19663")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627151919645.png",alt:"image-20230627151919645"}})]),s._v(" "),a("p",[s._v("2，按H，获取每个线程的内存情况")]),s._v(" "),a("p",[s._v("​    "),a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627151925367.png",alt:"image-20230627151925367"}})]),s._v(" "),a("p",[s._v("3，找到内存和cpu占用最高的线程tid，比如19664")]),s._v(" "),a("p",[s._v("4，转为十六进制得到 0x4cd0，此为线程id的十六进制表示 （top看的是操作系统的线程，而jstack中展示线程时，操作系统线程展示的是16进制，所以要进行装换）")]),s._v(" "),a("p",[s._v("5，执行 jstack 19663|grep -A 10 4cd0，得到线程堆栈信息中 4cd0 这个线程所在行的后面10行，从堆栈中可以发现导致cpu飙高的调用方法")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627151931965.png",alt:"image-20230627151931965"}})]),s._v(" "),a("p",[s._v("6，查看对应的堆栈信息找出可能存在问题的代码")]),s._v(" "),a("h2",{attrs:{id:"_3-jinfo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-jinfo"}},[s._v("#")]),s._v(" 3. "),a("strong",[s._v("Jinfo")])]),s._v(" "),a("p",[s._v("查看正在运行的Java应用程序的扩展参数")]),s._v(" "),a("h3",{attrs:{id:"_1-jinfo-flags-14124"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-jinfo-flags-14124"}},[s._v("#")]),s._v(" ① jinfo -flags 14124")]),s._v(" "),a("p",[s._v("查看jvm的参数")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627151937116.png",alt:"image-20230627151937116"}})]),s._v(" "),a("h3",{attrs:{id:"_2jinfo-sysprops-14124"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2jinfo-sysprops-14124"}},[s._v("#")]),s._v(" ②jinfo -sysprops 14124")]),s._v(" "),a("p",[s._v("查看java系统参数")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627151942966.png",alt:"image-20230627151942966"}})]),s._v(" "),a("h2",{attrs:{id:"_4-jstat"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-jstat"}},[s._v("#")]),s._v(" 4."),a("strong",[s._v("Jstat")])]),s._v(" "),a("p",[s._v("jstat命令可以查看堆内存各部分的使用量，以及加载类的数量。命令的格式如下：")]),s._v(" "),a("p",[s._v("jstat [-命令选项] [vmid] [间隔时间(毫秒)] [查询次数]")]),s._v(" "),a("p",[s._v("注意：使用的jdk版本是jdk8")]),s._v(" "),a("p",[s._v("垃圾回收统计")]),s._v(" "),a("h3",{attrs:{id:"_1-jstat-gc-pid"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-jstat-gc-pid"}},[s._v("#")]),s._v(" ①**jstat -gc pid **")]),s._v(" "),a("p",[a("strong",[s._v("最常用")]),s._v("，可以评估程序内存使用及GC压力整体情况")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627151948783.png",alt:"image-20230627151948783"}})]),s._v(" "),a("ul",[a("li",[s._v("S0C：第一个幸存区的大小，单位KB")]),s._v(" "),a("li",[s._v("S1C：第二个幸存区的大小")]),s._v(" "),a("li",[s._v("S0U：第一个幸存区的使用大小")]),s._v(" "),a("li",[s._v("S1U：第二个幸存区的使用大小")]),s._v(" "),a("li",[s._v("EC：伊甸园区的大小")]),s._v(" "),a("li",[s._v("EU：伊甸园区的使用大小")]),s._v(" "),a("li",[s._v("OC：老年代大小")]),s._v(" "),a("li",[s._v("OU：老年代使用大小")]),s._v(" "),a("li",[s._v("MC：方法区大小(元空间)")]),s._v(" "),a("li",[s._v("MU：方法区使用大小")]),s._v(" "),a("li",[s._v("CCSC:压缩类空间大小")]),s._v(" "),a("li",[s._v("CCSU:压缩类空间使用大小")]),s._v(" "),a("li",[s._v("YGC：年轻代垃圾回收次数")]),s._v(" "),a("li",[s._v("YGCT：年轻代垃圾回收消耗时间，单位s")]),s._v(" "),a("li",[s._v("FGC：老年代垃圾回收次数")]),s._v(" "),a("li",[s._v("FGCT：老年代垃圾回收消耗时间，单位s")]),s._v(" "),a("li",[s._v("GCT：垃圾回收消耗总时间，单位s")])]),s._v(" "),a("p",[s._v("堆内存统计")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627151955405.png",alt:"image-20230627151955405"}})]),s._v(" "),a("ul",[a("li",[s._v("NGCMN：新生代最小容量")]),s._v(" "),a("li",[s._v("NGCMX：新生代最大容量")]),s._v(" "),a("li",[s._v("NGC：当前新生代容量")]),s._v(" "),a("li",[s._v("S0C：第一个幸存区大小")]),s._v(" "),a("li",[s._v("S1C：第二个幸存区的大小")]),s._v(" "),a("li",[s._v("EC：伊甸园区的大小")]),s._v(" "),a("li",[s._v("OGCMN：老年代最小容量")]),s._v(" "),a("li",[s._v("OGCMX：老年代最大容量")]),s._v(" "),a("li",[s._v("OGC：当前老年代大小")]),s._v(" "),a("li",[s._v("OC:当前老年代大小")]),s._v(" "),a("li",[s._v("MCMN:最小元数据容量")]),s._v(" "),a("li",[s._v("MCMX：最大元数据容量")]),s._v(" "),a("li",[s._v("MC：当前元数据空间大小")]),s._v(" "),a("li",[s._v("CCSMN：最小压缩类空间大小")]),s._v(" "),a("li",[s._v("CCSMX：最大压缩类空间大小")]),s._v(" "),a("li",[s._v("CCSC：当前压缩类空间大小")]),s._v(" "),a("li",[s._v("YGC：年轻代gc次数")]),s._v(" "),a("li",[s._v("FGC：老年代GC次数")])]),s._v(" "),a("p",[s._v("新生代垃圾回收统计")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627152002286.png",alt:"image-20230627152002286"}})]),s._v(" "),a("ul",[a("li",[s._v("S0C：第一个幸存区的大小")]),s._v(" "),a("li",[s._v("S1C：第二个幸存区的大小")]),s._v(" "),a("li",[s._v("S0U：第一个幸存区的使用大小")]),s._v(" "),a("li",[s._v("S1U：第二个幸存区的使用大小")]),s._v(" "),a("li",[s._v("TT:对象在新生代存活的次数")]),s._v(" "),a("li",[s._v("MTT:对象在新生代存活的最大次数")]),s._v(" "),a("li",[s._v("DSS:期望的幸存区大小")]),s._v(" "),a("li",[s._v("EC：伊甸园区的大小")]),s._v(" "),a("li",[s._v("EU：伊甸园区的使用大小")]),s._v(" "),a("li",[s._v("YGC：年轻代垃圾回收次数")]),s._v(" "),a("li",[s._v("YGCT：年轻代垃圾回收消耗时间")])]),s._v(" "),a("p",[s._v("新生代内存统计")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627152007637.png",alt:"image-20230627152007637"}})]),s._v(" "),a("ul",[a("li",[s._v("NGCMN：新生代最小容量")]),s._v(" "),a("li",[s._v("NGCMX：新生代最大容量")]),s._v(" "),a("li",[s._v("NGC：当前新生代容量")]),s._v(" "),a("li",[s._v("S0CMX：最大幸存1区大小")]),s._v(" "),a("li",[s._v("S0C：当前幸存1区大小")]),s._v(" "),a("li",[s._v("S1CMX：最大幸存2区大小")]),s._v(" "),a("li",[s._v("S1C：当前幸存2区大小")]),s._v(" "),a("li",[s._v("ECMX：最大伊甸园区大小")]),s._v(" "),a("li",[s._v("EC：当前伊甸园区大小")]),s._v(" "),a("li",[s._v("YGC：年轻代垃圾回收次数")]),s._v(" "),a("li",[s._v("FGC：老年代回收次数")])]),s._v(" "),a("p",[s._v("老年代垃圾回收统计")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627152013090.png",alt:"image-20230627152013090"}})]),s._v(" "),a("ul",[a("li",[s._v("MC：方法区大小")]),s._v(" "),a("li",[s._v("MU：方法区使用大小")]),s._v(" "),a("li",[s._v("CCSC:压缩类空间大小")]),s._v(" "),a("li",[s._v("CCSU:压缩类空间使用大小")]),s._v(" "),a("li",[s._v("OC：老年代大小")]),s._v(" "),a("li",[s._v("OU：老年代使用大小")]),s._v(" "),a("li",[s._v("YGC：年轻代垃圾回收次数")]),s._v(" "),a("li",[s._v("FGC：老年代垃圾回收次数")]),s._v(" "),a("li",[s._v("FGCT：老年代垃圾回收消耗时间")]),s._v(" "),a("li",[s._v("GCT：垃圾回收消耗总时间")])]),s._v(" "),a("p",[s._v("老年代内存统计")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627152017677.png",alt:"image-20230627152017677"}})]),s._v(" "),a("ul",[a("li",[s._v("OGCMN：老年代最小容量")]),s._v(" "),a("li",[s._v("OGCMX：老年代最大容量")]),s._v(" "),a("li",[s._v("OGC：当前老年代大小")]),s._v(" "),a("li",[s._v("OC：老年代大小")]),s._v(" "),a("li",[s._v("YGC：年轻代垃圾回收次数")]),s._v(" "),a("li",[s._v("FGC：老年代垃圾回收次数")]),s._v(" "),a("li",[s._v("FGCT：老年代垃圾回收消耗时间")]),s._v(" "),a("li",[s._v("GCT：垃圾回收消耗总时间")])]),s._v(" "),a("p",[s._v("元数据空间统计")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627152022557.png",alt:"image-20230627152022557"}})]),s._v(" "),a("ul",[a("li",[s._v("MCMN:最小元数据容量")]),s._v(" "),a("li",[s._v("MCMX：最大元数据容量")]),s._v(" "),a("li",[s._v("MC：当前元数据空间大小")]),s._v(" "),a("li",[s._v("CCSMN：最小压缩类空间大小")]),s._v(" "),a("li",[s._v("CCSMX：最大压缩类空间大小")]),s._v(" "),a("li",[s._v("CCSC：当前压缩类空间大小")]),s._v(" "),a("li",[s._v("YGC：年轻代垃圾回收次数")]),s._v(" "),a("li",[s._v("FGC：老年代垃圾回收次数")]),s._v(" "),a("li",[s._v("FGCT：老年代垃圾回收消耗时间")]),s._v(" "),a("li",[s._v("GCT：垃圾回收消耗总时间")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627152027304.png",alt:"image-20230627152027304"}})]),s._v(" "),a("ul",[a("li",[s._v("S0：幸存1区当前使用比例")]),s._v(" "),a("li",[s._v("S1：幸存2区当前使用比例")]),s._v(" "),a("li",[s._v("E：伊甸园区使用比例")]),s._v(" "),a("li",[s._v("O：老年代使用比例")]),s._v(" "),a("li",[s._v("M：元数据区使用比例")]),s._v(" "),a("li",[s._v("CCS：压缩使用比例")]),s._v(" "),a("li",[s._v("YGC：年轻代垃圾回收次数")]),s._v(" "),a("li",[s._v("FGC：老年代垃圾回收次数")]),s._v(" "),a("li",[s._v("FGCT：老年代垃圾回收消耗时间")]),s._v(" "),a("li",[s._v("GCT：垃圾回收消耗总时间")])]),s._v(" "),a("p",[a("code",[s._v("jstat -gc 1323 2000 10000")]),s._v("2秒执行10000次")]),s._v(" "),a("h3",{attrs:{id:"_2jstat的更多用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2jstat的更多用法"}},[s._v("#")]),s._v(" ②jstat的更多用法")]),s._v(" "),a("p",[a("strong",[s._v("JVM运行情况预估")])]),s._v(" "),a("p",[s._v("用 jstat gc -pid 命令可以计算出如下一些关键数据，有了这些数据就可以采用之前介绍过的优化思路，先给自己的系统设置一些初始性的JVM参数，比如堆内存大小，年轻代大小，Eden和Survivor的比例，老年代的大小，大对象的阈值，大龄对象进入老年代的阈值等。")]),s._v(" "),a("p",[a("strong",[s._v("年轻代对象增长的速率")])]),s._v(" "),a("p",[s._v("可以执行命令 jstat -gc pid 1000 10 (每隔1秒执行1次命令，共执行10次)，通过观察EU(eden区的使用)来估算每秒eden大概新增多少对象，如果系统负载不高，可以把频率1秒换成1分钟，甚至10分钟来观察整体情况。注意，一般系统可能有高峰期和日常期，所以需要在不同的时间分别估算不同情况下对象增长速率。")]),s._v(" "),a("p",[a("strong",[s._v("Young GC的触发频率和每次耗时")])]),s._v(" "),a("p",[s._v("知道年轻代对象增长速率我们就能推根据eden区的大小推算出Young GC大概多久触发一次，Young GC的平均耗时可以通过 YGCT/YGC 公式算出，根据结果我们大概就能知道"),a("strong",[s._v("系统大概多久会因为Young GC的执行而卡顿多久。")])]),s._v(" "),a("p",[a("strong",[s._v("每次Young GC后有多少对象存活和进入老年代")])]),s._v(" "),a("p",[s._v("这个因为之前已经大概知道Young GC的频率，假设是每5分钟一次，那么可以执行命令 jstat -gc pid 300000 10 ，观察每次结果eden，survivor和老年代使用的变化情况，在每次gc后eden区使用一般会大幅减少，survivor和老年代都有可能增长，这些增长的对象就是每次Young GC后存活的对象，同时还可以看出每次Young GC后进去老年代大概多少对象，从而可以推算出"),a("strong",[s._v("老年代对象增长速率。")])]),s._v(" "),a("p",[a("strong",[s._v("Full GC的触发频率和每次耗时")])]),s._v(" "),a("p",[s._v("知道了老年代对象的增长速率就可以推算出Full GC的触发频率了，Full GC的每次耗时可以用公式 FGCT/FGC 计算得出。")]),s._v(" "),a("p",[a("strong",[s._v("优化思路")]),s._v("其实简单来说就是尽量让每次Young GC后的存活对象小于Survivor区域的50%，都留存在年轻代里。尽量别让对象进入老年代。尽量减少Full GC的频率，避免频繁Full GC对JVM性能的影响。")]),s._v(" "),a("h2",{attrs:{id:"_5-案例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-案例"}},[s._v("#")]),s._v(" 5. 案例")]),s._v(" "),a("p",[s._v("代码地址："),a("a",{attrs:{href:""}},[s._v("github")])]),s._v(" "),a("p",[a("strong",[s._v("系统频繁Full GC导致系统卡顿是怎么回事")])]),s._v(" "),a("ul",[a("li",[s._v("机器配置：2核4G")]),s._v(" "),a("li",[s._v("JVM内存大小：2G")]),s._v(" "),a("li",[s._v("系统运行时间：7天")]),s._v(" "),a("li",[s._v("期间发生的Full GC次数和耗时：500多次，200多秒")]),s._v(" "),a("li",[s._v("期间发生的Young GC次数和耗时：1万多次，500多秒")])]),s._v(" "),a("p",[s._v("大致算下来每天会发生70多次Full GC，平均每小时3次，每次Full GC在400毫秒左右；")]),s._v(" "),a("p",[s._v("每天会发生1000多次Young GC，每分钟会发生1次，每次Young GC在50毫秒左右。")]),s._v(" "),a("p",[s._v("JVM参数设置如下：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xms1536M")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xmx1536M")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xmn512M")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xss256K")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SurvivorRatio")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MetaspaceSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),s._v("M "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MaxMetaspaceSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),s._v("M  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UseParNewGC")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UseConcMarkSweepGC")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CMSInitiatingOccupancyFraction")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UseCMSInitiatingOccupancyOnly")]),s._v("             \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("-Xms1536M：指定 JVM 的初始堆内存大小为 1536MB。这是 JVM 在启动时分配给堆的初始内存量。\n\n-Xmx1536M：指定 JVM 的最大堆内存大小为 1536MB。这是 JVM 在运行过程中堆可以增长到的最大内存量。\n\n-Xmn512M：指定 JVM 的年轻代堆内存大小为 512MB。年轻代是 JVM 堆的一部分，用于存储新创建的对象。\n\n-Xss256K：指定 JVM 的线程栈大小为 256KB。每个线程在 JVM 中都有一个对应的栈，用于存储方法调用和局部变量等信息。\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:SurvivorRatio")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("：指定 JVM 中 Eden 空间和 Survivor 空间的比例为 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(":1。Eden 空间是年轻代堆内存中用于存储新创建对象的区域，而 Survivor 空间用于存储幸存的对象。\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MetaspaceSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("256M：指定 JVM 的元空间（Metaspace）的初始大小为 256MB。元空间用于存储类的元数据信息。\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MaxMetaspaceSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("256M：指定 JVM 的元空间的最大大小为 256MB。当元空间达到这个限制时，JVM 会触发垃圾回收来释放未使用的类信息。\n\n-XX:+UseParNewGC：启用并行的年轻代垃圾收集器。这个收集器主要用于多核处理器环境中的新生代垃圾收集。\n\n-XX:+UseConcMarkSweepGC：启用并发标记清除垃圾收集器。这个收集器主要用于在运行过程中与应用程序并发执行垃圾回收操作。\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:CMSInitiatingOccupancyFraction")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v("：设置并发标记清除垃圾收集器在堆空间达到 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v("% 使用率时触发垃圾回收。\n\n-XX:+UseCMSInitiatingOccupancyOnly：启用仅在堆空间达到 CMSInitiatingOccupancyFraction 阈值时触发 CMS 垃圾回收的模式。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("blockquote",[a("p",[s._v("-XX:CMSInitiatingOccupancyFraction=75 表示当old中的容量达到75%时，触发full GC")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627171257733.png",alt:"image-20230627171257733"}})]),s._v(" "),a("blockquote",[a("p",[s._v("更深层次可以看出 每20min就有700M的数据移动到了old中")]),s._v(" "),a("p",[s._v("大家可以结合"),a("strong",[s._v("对象挪动到老年代那些规则")]),s._v("推理下我们这个程序可能存在的一些问题")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("大对象直接进入老年代")])]),s._v(" "),a("li",[a("p",[s._v("长期存活的对象进入老年代")])]),s._v(" "),a("li",[a("p",[s._v("对象动态年龄机制")])]),s._v(" "),a("li",[a("p",[s._v("老年代空间分配担保")])])])]),s._v(" "),a("p",[s._v("经过分析感觉可能会由于对象动态年龄判断机制导致full gc较为频繁")]),s._v(" "),a("p",[s._v("为了给大家看效果，我模拟了一个示例程序(见课程对应工程代码：jvm-full-gc)，打印了jstat的结果如下：")]),s._v(" "),a("p",[a("code",[s._v("jstat -gc 13456 2000 10000")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627171304923.png",alt:"image-20230627171304923"}})]),s._v(" "),a("p",[s._v("对于对象动态年龄判断机制导致的full gc较为频繁可以先试着优化下JVM参数，把年轻代适当调大点：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xms1536M")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xmx1536M")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xmn1024M")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xss256K")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SurvivorRatio")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MetaspaceSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),s._v("M "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MaxMetaspaceSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),s._v("M  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UseParNewGC")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UseConcMarkSweepGC")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CMSInitiatingOccupancyFraction")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("92")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UseCMSInitiatingOccupancyOnly")]),s._v("  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("​")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627171319104.png",alt:"image-20230627171319104"}})]),s._v(" "),a("p",[s._v("优化完发现没什么变化，"),a("strong",[s._v("full gc的次数比minor gc的次数还多了")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627173328504.png",alt:"image-20230627173328504"}})]),s._v(" "),a("p",[s._v("我们可以推测下full gc比minor gc还多的原因有哪些？(实际上是空间分配担保机制)")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230627164629624.png",alt:"image-20230627164629624"}})]),s._v(" "),a("p",[s._v("1、元空间不够导致的多余full gc（查看MU可以看到元空间的数据基本大小没有怎么变化）")]),s._v(" "),a("p",[s._v("2、显示调用System.gc()造成多余的full gc，这种一般线上尽量通过-XX:+DisableExplicitGC参数禁用，如果加上了这个JVM启动参数，那么代码中调用System.gc()没有任何效果")]),s._v(" "),a("p",[s._v("3、老年代空间分配担保机制")]),s._v(" "),a("p",[s._v("是不是大对象的移动")]),s._v(" "),a("p",[s._v("最快速度分析完这些我们推测的原因以及优化后，我们发现young gc和full gc依然很频繁了，而且看到有大量的对象频繁的被挪动到老年代，这种情况我们可以借助jmap命令大概看下是什么对象")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/image-20230628162805535.png",alt:"image-20230628162805535"}})]),s._v(" "),a("p",[s._v("查到了有大量User对象产生，这个可能是问题所在，但不确定，还必须找到对应的代码确认，如何去找对应的代码了？")]),s._v(" "),a("p",[s._v("1、代码里全文搜索生成User对象的地方(适合只有少数几处地方的情况)")]),s._v(" "),a("p",[s._v("2、如果生成User对象的地方太多，无法定位具体代码，我们可以同时分析下占用cpu较高的线程，一般有大量对象不断产生，对应的方法代码肯定会被频繁调用，占用的cpu必然较高")]),s._v(" "),a("p",[s._v("可以用上面讲过的jstack或jvisualvm来定位cpu使用较高的代码，最终定位到的代码如下：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jvm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token import"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("web"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bind"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RequestMapping")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token import"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("web"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bind"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RestController")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token import"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RestController")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IndexController")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RequestMapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/user/process"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("processUserData")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" users "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryUsers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//TODO 业务处理")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user:"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"end"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 模拟批量查询用户场景\n     * @return\n     */")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryUsers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" users "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"zhuge"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br")])]),a("p",[s._v("​")]),s._v(" "),a("p",[s._v("同时，java的代码也是需要优化的，一次查询出500M的对象出来，明显不合适，要根据之前说的各种原则尽量优化到合适的值，尽量消除这种朝生夕死的对象导致的full gc")]),s._v(" "),a("p",[a("strong",[s._v("内存泄露到底是怎么回事")])]),s._v(" "),a("p",[s._v("再给大家讲一种情况，一般电商架构可能会使用多级缓存架构，就是redis加上JVM级缓存，大多数同学可能为了图方便对于JVM级缓存就简单使用一个hashmap，于是不断往里面放缓存数据，但是很少考虑这个map的容量问题，结果这个缓存map越来越大，一直占用着老年代的很多空间，时间长了就会导致full gc非常频繁，这就是一种内存泄漏，对于一些老旧数据没有及时清理导致一直占用着宝贵的内存资源，时间长了除了导致full gc，还有可能导致OOM。")]),s._v(" "),a("p",[s._v("这种情况完全可以考虑采用一些成熟的JVM级缓存框架来解决，比如ehcache等自带一些LRU数据淘汰算法的框架来作为JVM级的缓存。")])])}),[],!1,null,null,null);a.default=e.exports}}]);