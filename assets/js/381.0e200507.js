(window.webpackJsonp=window.webpackJsonp||[]).push([[381],{706:function(s,t,a){"use strict";a.r(t);var e=a(4),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"背景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[s._v("#")]),s._v(" 背景")]),s._v(" "),t("p",[s._v("我在使用mac的过程中，下载了一些如zookeeper、redis等软件，但是每次启动的时候，")]),s._v(" "),t("ul",[t("li",[s._v("我可能需要重新去对应的路径下使用shell命令启动一次。")]),s._v(" "),t("li",[s._v("长时间不用，下一次需要使用可能会忘记安装的路径在哪里，可能会忘记启动命令是什么。")])]),s._v(" "),t("p",[s._v("如果我们可以让电脑在开机时能够自行启动，那么以上的问题都可以轻松的解决")]),s._v(" "),t("h2",{attrs:{id:"一-systemd系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一-systemd系统"}},[s._v("#")]),s._v(" 一.systemd系统")]),s._v(" "),t("p",[s._v("什么是systemd")]),s._v(" "),t("p",[s._v('你正在运行一个基于 systemd 的操作系统，传统的 init 脚本已被本地的 systemd 服务文件所取代。服务文件提供了非常类似于 init 脚本的功能。要使用服务文件，只需调用 "systemctl" 命令，它将输出所有当前运行的服务（和其他单元）的列表。使用 "systemctl list-unit-files" 命令获取所有已知单元文件的列表，包括已停止、禁用和屏蔽的单元文件。使用 "systemctl start foobar.service" 和 "systemctl stop foobar.service" 分别启动或停止一个服务。有关更多详细信息，请参考 systemctl(1)。')]),s._v(" "),t("p",[s._v("请注意，在 systemd 系统上，传统的 init 脚本仍然能够正常工作。在系统初始化期间，init 脚本 /etc/rc.d/init.d/foobar 会被隐式映射到一个服务单元 foobar.service 中。")]),s._v(" "),t("p",[s._v("使用"),t("code",[s._v("ps -ef | grep systemd")]),s._v("查看是否是systemd系统")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/undefinedundefinedimage-20230225150627147.png",alt:"image-20230225150627147"}})]),s._v(" "),t("h3",{attrs:{id:"自启举例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自启举例"}},[s._v("#")]),s._v(" 自启举例")]),s._v(" "),t("p",[s._v("linux很多都是用过systemd来进行开机执行的shell")]),s._v(" "),t("p",[s._v("例如以下命令大家有可能都是用过：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start httpd\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重启：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart httpd\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#停止：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl stop httpd\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置开机启动：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" httpd\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("那如果我们也想要编写一个shell脚本，让开机的时候能够自行启动的话呢？")]),s._v(" "),t("h3",{attrs:{id:"步骤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#步骤"}},[s._v("#")]),s._v(" 步骤")]),s._v(" "),t("ol",[t("li",[s._v("首先，我们需要先写好我们对应的开机脚本，并cd到对应的文件目录")])]),s._v(" "),t("p",[s._v("例如:")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /home/tommy\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("编写相关的service文件（重要）")])]),s._v(" "),t("p",[s._v("只需要修改 ExecStart 和 ExecReload 等为你需要执行的 shell 脚本即可")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Unit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Description")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Documentation")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("After")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("network.target\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Wants")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Requires")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Service"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/downey/test.sh  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用start命令时使用的脚本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStop")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecReload")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/downey/test.sh "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 机器重启时使用的脚本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Type")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("simple\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Install"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("WantedBy")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("multi-user.target\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[t("p",[s._v("将 service 脚本放到 /etc/systemd/system/ 或者 /usr/lib/systemd/system 目录")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("cp /路径/test.sh /etc/systemd/system/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("测试启动")])])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start test.service\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"5"}},[t("li",[s._v("添加开机启动")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("sudo systemctl enable test.service\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"6"}},[t("li",[s._v("重启检查一下 设置是否生效")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("reboot\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"7"}},[t("li",[s._v("查看systemd服务状态")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" test.service\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"二-mac系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二-mac系统"}},[s._v("#")]),s._v(" 二.mac系统")]),s._v(" "),t("ol",[t("li",[s._v("编写一个shell脚本")]),s._v(" "),t("li",[s._v("修改shell文件的脚本为")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" run.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("3、右键点击run.sh->显示简介，主要将打开方式修改为终端，共享和权限将所有权限打开。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/undefined1219668-20190819173352383-509519464.png",alt:"img"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/undefined1219668-20190819173045366-32093091.png",alt:"img"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/undefined1219668-20190819173502114-2052532113.png",alt:"img"}})]),s._v(" "),t("p",[s._v("4、进入系统偏好设置->用户与群组->登陆项，将haha.sh添加到登陆项，并勾选前面的隐藏选项卡，重新启动即可。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/undefined1219668-20190819173755882-391568179.png",alt:"img"}})]),s._v(" "),t("p",[s._v("5.验证：")]),s._v(" "),t("p",[s._v("现在 Documents目录下不存在文件夹")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/undefined1219668-20190819174411982-798561298.png",alt:"img"}})]),s._v(" "),t("p",[s._v("重启电脑后，再看一下这个文录，已经有haha文件夹了，说明run.sh脚本开机已经自启动了")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://2290653824-github-io.oss-cn-hangzhou.aliyuncs.com/undefined1219668-20190819175722925-842993793.png",alt:"img"}})]),s._v(" "),t("h2",{attrs:{id:"常见问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常见问题"}},[s._v("#")]),s._v(" 常见问题")]),s._v(" "),t("h3",{attrs:{id:"权限问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#权限问题"}},[s._v("#")]),s._v(" 权限问题")]),s._v(" "),t("p",[s._v("自动执行某些脚本，因为用户还没有登录导致权限不足")]),s._v(" "),t("p",[s._v("在shell脚本中使用sudo命令，可以通过配置sudoers文件来避免需要手动输入密码。")]),s._v(" "),t("p",[s._v("以下是一些步骤来设置sudoers文件：")]),s._v(" "),t("ol",[t("li",[s._v("打开终端并输入以下命令以编辑sudoers文件：")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Copy code\nsudo visudo\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("在sudoers文件中添加一行来允许指定的用户执行sudo命令而不需要输入密码。例如：")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("sqlCopy code\nyourusername ALL=(ALL) NOPASSWD: ALL\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v('请将"yourusername"替换为你的用户名。')]),s._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[s._v("保存并退出sudoers文件。")])]),s._v(" "),t("p",[s._v("现在，你可以在shell脚本中使用sudo命令而不需要输入密码。")]),s._v(" "),t("p",[s._v("例如，如果你想在shell脚本中以root权限创建一个名为“testfile”的文件，你可以使用以下命令：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("bashCopy code\nsudo touch /path/to/testfile\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("另外如果还是不行，建议将受影响的目录修改权限")]),s._v(" "),t("div",{staticClass:"language-SHELL line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" /path\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);